---
title: '2021 Forbes Billionaires '
author: R package build
date: '2022-04-26'
slug: 2021-forbes-billionaires
categories: []
tags: []
---

# Forbes Billionaires 2021
#### This data set is from 2021. The Forbes 2022 Billionaire List differs. 22

###### Who were the billionaires with the top 10 highest net worths on the 2021 Forbes Billionaires List? How much are their net worths? What industry do they work in? Does any industry dominate the others? 
```{r, message = FALSE, warning = FALSE, echo = FALSE, results = 'hide'}
library(tidyverse)
library(here)
library(ggrepel)
billionaires <- read_csv(here("content/post/2022-04-26-2021-forbes-billionaires/Billionaire.csv"))
billionaires
forbes_billionaires <- read_csv(here("content/post/2022-04-26-2021-forbes-billionaires/forbes_billionaires.csv"))
forbes_billionaires 

top10 <- billionaires %>% filter(Rank <= 10) %>%
  mutate(NetWorth = parse_number(NetWorth)) %>%
  mutate(order = fct_reorder(.f = Name, .x = NetWorth)) %>%
  mutate(Industry = fct_relevel(Industry, c("Technology",
                                            "Automotive",
                                            "Fashion & Retail", 
                                            "Finance & Investments", 
                                            "Diversified")))
top10

new_names2 <- c("Mukesh Ambani", "Sergey Brin", "Larry Page", "Larry Ellison",
                "Warren Buffett", "Mark Zuckerberg", "Bill Gates", 
                "Bernard Arnault & Family", "Elon Musk", "Jeff Bezos")
```

```{r, message = FALSE, warning = FALSE, echo = FALSE, fig.height = 7, fig.width = 11}
ggplot(data = top10, aes(x = order, y = NetWorth, fill = Industry)) +
  geom_col(colour = "black") +
  coord_flip() +
  labs(x = " ", 
       y = "Net Worth",
       caption = "Measured in Billions",
       colour = "Industry",
       title = "2021 Forbes Billionaires",
       subtitle = "Examining the Highest Net Worths from 2021") +
  scale_fill_viridis_d() +
  scale_x_discrete(labels = new_names2) +
  theme(legend.position = c(0.835, 0.19)) +
  theme(axis.title = element_text(family = "mono",
                                  face = "bold",
                                  margin = margin(c(t = 30,
                                                    b = 30))),
        axis.text = element_text(family = "mono",
                                 face = "bold",
                                 size = 8),
        axis.text.y = element_text(face = "bold"),
        axis.ticks = element_blank(),
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  margin = margin(c(t = 15,
                                                    b = 15,
                                                    vjust = 15)),
                                  size = 16),
        plot.subtitle = element_text(family = "mono",
                                     size = 11,
                                     face = "italic",
                                       vjust = 2.5,
                                     hjust = 0.5),
        axis.title.x = element_text(vjust = -3,
                                    size = 10,
                                    hjust = 0.5),
        axis.title.y = element_text(vjust = 2),
        legend.title = element_text(family = "mono",
                                    face = "bold",
                                    size = 10),
        legend.text = element_text(family = "mono",
                                   face = "italic",
                                   size = 6),
        plot.caption = element_text(family = "mono",
                                    face = "italic",
                                    vjust = 5,
                                    hjust = 0.5,
                                    margin = margin(c(t = 30,
                                                      b = 30)),
                                    size = 10),
             plot.margin = margin(1, 1, 0.5, 0.2, "cm"),
        plot.background = element_rect(
    fill = "grey90",
    colour = "black",
    size = 3),
    legend.key.size = unit(0.3, 'cm'),
  legend.box.background = element_rect(size = 1.5)) +
  theme(plot.title = element_text(hjust = 0.5))
```

###### How many billionaires are there from the top 30 countries on the list? Do developed democracies have the most billionaires on the list?
```{r}
country <- forbes_billionaires %>% group_by(Country) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) 

country_30 <- country %>% slice(1:30) %>%
  mutate(order = fct_reorder(.f = Country, .x = n))
country_30
```

```{r, message = FALSE, warning = FALSE, echo = FALSE, fig.height = 7, fig.width = 11}
ggplot(data = country_30, aes(x = order, y = n, fill = n)) +
   geom_col(colour = "black") +
   coord_flip() +
   labs(x = " ", 
        y = " ",
        title = "How Many Billionaires Are There From the",
        subtitle = "30 Countries with the Most Billionaires",
        fill = "Count") +
   theme(plot.title = element_text(family = "mono",
                                   face = "bold",
                                   size = 15,
                                    margin = margin(c(t = 40,
                                                     b = 50)),
                                   hjust = 0.5,
                                   vjust = 8),
         plot.subtitle = element_text(family = "mono",
                                      face = "bold",
                                      size = 14,
                                      hjust = 0.5,
                                      vjust = 5),
         plot.background = element_rect(
      fill = "grey90",
      colour = "black",
      size = 3),
      plot.margin = margin(1, 1, 1, 0.5, unit = 'cm'),
         axis.text = element_text(family = "mono",
                                  face = "bold",
                                  size = 6.5),
         axis.title = element_text(family = "mono"),
         legend.title = element_text(family = "mono"),
         legend.text = element_text(family = "mono"),
         axis.ticks = element_blank(),
         legend.position = "none") +
   scale_fill_viridis_b(n.breaks = 6) +
   geom_text(aes(label = n, fontface = "bold", family = "mono"), hjust = -0.2, size = 2.5, colour = "black")
```

###### What is the average age of the billionaires from the 10 countries with the most billionaires? Is there a pattern or do the averages widely differ? Are there any interesting outliers? 

```{r, message = FALSE, warning = FALSE, echo = FALSE, results = 'hide'}
forbes_billionaires_age <- forbes_billionaires %>%
  mutate(age = as.numeric(Age)) %>%
  select(age, everything())
forbes_billionaires_age

countries_10 <- forbes_billionaires_age %>% filter(Country == "United States" |
           Country == "China" |
           Country == "India" |
           Country == "Germany" |
           Country == "Russia" |
           Country == "Hong Kong" |
           Country == "Brazil" |
           Country == "Canada" |
           Country == "United Kingdom" |
           Country == "Italy") 
countries_10

ggplot(data = countries_10, aes(x = Country, y = age)) +
  geom_point() +
  coord_flip() 

countries_10_no_missing_values <- countries_10 %>% filter(!is.na(age))
countries_10_no_missing_values

outliers_age <- countries_10_no_missing_values %>% filter(age < 25 | age > 97)
outliers_age

countries_10_average_age <- countries_10_no_missing_values %>% group_by(Country) %>%
  summarise(Average = mean(age)) %>%
  arrange(desc(Average)) %>% 
  mutate(order = fct_reorder(.f = Country, .x = Average)) %>%
  rename(age = 'Average')
countries_10_average_age

level_order3 <- factor(countries_10$Country, level = c('China',
                                                                   'Russia',
                                                                   'Brazil',
                                                                   'Germany',
                                                                   'Canada',
                                                                   'Hong Kong',
                                                                   'United States',
                                                                   'United Kingdom',
                                                                   'India',
                                                       'Italy'))
```

```{r, message = FALSE, warning = FALSE, echo = FALSE}
## In order of highest to lowest age 

ggplot(data = countries_10, aes(x = level_order3, y = age)) +
  geom_point(alpha = 0.7) +
  coord_flip() +
  geom_point(data = countries_10_average_age, aes(x = Country, y = age, colour = "Mean Age of Billionaires"),
             size = 2) +
  scale_colour_manual(values = c("Mean Age of Billionaires" = "red")) +
  labs(x = " ", 
       y = " ",
       title = "Average Age of Billionaires by Country") +
  theme(legend.position = "bottom") +
  theme(axis.title = element_text(family = "mono",
                                  face = "bold"),
        axis.text = element_text(family = "mono"),
        axis.text.y = element_text(face = "bold"),
        axis.text.x = element_text(face = "bold"),
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 13,
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.ticks = element_blank(),
        legend.title = element_blank(),
        legend.text = element_text(family = "mono",
                                   face = "bold"), 
        plot.caption = element_text(family = "mono",
                                    size = 9,
                                    face = "italic"),
        legend.key.size = unit(0.3, 'cm'),
             plot.margin = margin(0.5, 1, 0.5, 0.5, "cm"),
        plot.background = element_rect(
    fill = "grey90",
    colour = "black",
    size = 3),
  legend.box.background = element_rect(size = 1.5)) +
  theme(plot.title = element_text(hjust = 0.5)) 
```

```{r, message = FALSE, warning = FALSE, echo = FALSE}

## Outliers labeled 

ggplot(data = countries_10, aes(x = Country, y = age)) +
  geom_point(alpha = 0.4, size = 1.5) +
  coord_flip() +
  geom_point(data = countries_10_average_age, aes(x = order, y = age, colour = "Mean Age of Billionaires"),
             size = 2.5) +
  scale_colour_manual(values = c("Mean Age of Billionaires" = "red")) +
  labs(x = " ", 
       y = " ",
       title = "Average Age of Billionaires by Country") +
  theme(legend.position = "bottom") +
  theme(axis.title = element_text(family = "mono",
                                  face = "bold"),
        axis.text = element_text(family = "mono",
                                 face = "bold",
                                 size = 6),
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 13,
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  hjust = 0.5,
                                  vjust = 10),
        axis.ticks = element_blank(),
        legend.title = element_blank(),
             plot.margin = margin(0.5, 1, 0.5, 0.5, "cm"),
        plot.background = element_rect(
    fill = "grey90",
    colour = "black",
    size = 3),
        legend.text = element_text(family = "mono",
                                   face = "italic"), 
    legend.key.size = unit(0.3, 'cm'),
    legend.box.background = element_rect(size = 1.5),
        plot.caption = element_text(family = "mono",
                                    size = 9,
                                    face = "italic")) +
  theme(legend.position = "bottom") +
    geom_label_repel(data = outliers_age, aes(label = age))
```

```{r, message = FALSE, warning = FALSE, echo = FALSE, results = 'hide'}

## averages labeled 

  ggplot(data = countries_10, aes(x = Country, y = age)) +
  geom_point(alpha = 0.7) +
  coord_flip() +
  geom_point(data = countries_10_average_age, aes(x = Country, y = age, colour = "Mean Age of Billionaires"),
             size = 2) +
  scale_colour_manual(values = c("Mean Age of Billionaires" = "red")) +
  labs(x = " ", 
       y = " ",
       title = "Average Age of Billionaires by Country") +
  theme(legend.position = "bottom") +
  theme(axis.title = element_text(family = "mono",
                                  face = "bold"),
        axis.text = element_text(family = "mono"),
        axis.text.y = element_text(face = "bold"),
        axis.text.x = element_text(face = "bold"),
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 18,
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.ticks = element_blank(),
        legend.title = element_blank(),
        legend.text = element_text(family = "mono",
                                   face = "bold"), 
        plot.caption = element_text(family = "mono",
                                    size = 9,
                                    face = "italic"),
        legend.key.size = unit(1.2, 'cm'),
             plot.margin = margin(1, 1, 1, 1, "cm"),
        plot.background = element_rect(
    fill = "grey90",
    colour = "black",
    size = 3),
  legend.box.background = element_rect()) +
  geom_text(data = countries_10_average_age, aes(label = age))
```


```{r, message = FALSE, warning = FALSE, echo = FALSE, results = 'hide'}
usa_df <- billionaires %>% filter(Country == "United States") %>% mutate(networth = parse_number(NetWorth)) 
usa_df

usa_df %>% group_by(Industry) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

usa_avg_df <- usa_df %>%
   summarise(avg = mean(networth))
usa_avg_df

above_or_below_us <- usa_df %>% mutate(avg = mean(networth)) %>%
  mutate(above_avg = if_else(networth > 6.08,
                                      true = "ABOVE AVG",
                                      false = "BELOW AVG")) %>%
  filter(Industry == "Fashion & Retail" &
           Country == "United States") %>%
  mutate(order = fct_reorder(.f = Name, .x = networth))
above_or_below_us 
```

###### How many Billionaires in the Fashion Industry fall above and below the average net worth of American 
```{r, message = FALSE, warning = FALSE, echo = FALSE, fig.height = 11}
ggplot(data = above_or_below_us, aes(x = order, y = networth, colour = above_avg)) +
  geom_segment(aes(x = order, xend = order, y = avg, yend = networth)) +
  geom_point() +
  scale_colour_brewer(palette = "Accent") +
  coord_flip() +
  labs(x = " ",
      y = "Net Worth",
      caption = "Measured in Billions",
      colour = "Average",
      title = "U.S. Billionaires In The Fashion Industry",
      subtitle = "How Many Fall Above or Below the Average U.S. Billionaire Net Worth?") +
  theme(axis.text = element_text(family = "mono"),
        axis.title = element_text(family = "mono"),
        legend.text = element_text(family = "mono",
                                   face = "bold"),
        legend.title = element_text(family = "mono",
                                    face = "bold",
                                    size = 10),
        plot.caption = element_text(family = "mono",
                                    hjust = 0.5,
                                    size = 6, 
                                    vjust = 1,
                                    margin = margin(c(t = 10,
                                                      b = 20))),
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  margin = margin(c(t = 20,
                                                    b = 20)),
                                  hjust = 0.5,
                                  vjust = 5, 
                                  size = 14),
        plot.subtitle = element_text(family = "mono",
                                     face = "italic",
                                     margin = margin(c(t = 10, b = 10)),
                                     hjust = 0.5,
                                     vjust = 7,
                                     size = 9),
        axis.title.x = element_text(face = "bold",
                                    margin = margin(c(t = 10, b = 10)),
                                    size = 8),
             plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
        plot.background = element_rect(
    fill = "grey90",
    colour = "black",
    size = 3),
        axis.text.y = element_text(face = "bold",
                                   size = 5),
        axis.ticks = element_blank(),
        legend.box.background = element_rect(size = 1.5),
        legend.position = c(0.85, 0.15),
         legend.key.width = unit(0.5, 'cm'),
        legend.key.height = unit(0.5, 'cm'))
```

###### Put kable table with all the billionaires before this
###### Myabe change table from How many Billionaires are self-made to how many are self-made by industry 
```{r}
forbes_billionaires %>% select(Self_made, everything())
self_made <- forbes_billionaires %>% group_by(Self_made) %>%
  summarise(n = n()) %>%
  filter(!is.na(Self_made)) 

ggplot(data = self_made, aes(x = Self_made, y = n, fill = Self_made)) +
  geom_col(colour = "black") +
  scale_fill_brewer(palette = "Spectral") +
  labs(x = " ",
       y = " ",
       title = "How Many Forbes Billionaires Are Self-Made?",
       fill = " ") +
  theme(plot.title = element_text(family = "mono",
                                  face = "bold",
                                  margin = margin(c(t = 30)),
                                  hjust = 0.5,
                                  vjust = 8,
                                  size = 15),
        legend.text = element_text(family = "mono"),
        axis.text = element_text(family = "mono"),
        axis.text.x = element_text(size = 15,
                                   face = "bold"),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
             plot.margin = margin(1, 1, 1, 1, "cm"),
        plot.background = element_rect(
    fill = "grey90",
    colour = "black",
    size = 3),
        legend.position = "none") +
  geom_label(data = self_made, aes(label = n),
              fill = "white",
             label.size = 0.5) 
```

###### Make just one more visualization that makes sense 
```{r}
industry <- billionaires %>% group_by(Industry) %>%
  summarise(n = n()) %>%
  arrange(desc(n))
industry

combined_billionaires <- left_join(forbes_billionaires, billionaires, by = c("Name" = "Name"))


combined_billionaires2 <- combined_billionaires %>% separate(col = Education, into = c("Degree", "University"),
                                 sep = ", ")

harvard <- combined_billionaires2 %>% filter(University == "Harvard University") 
harvard

harvard %>% group_by(Industry) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

ggplot(data = harvard, aes(x = Degree, y = NetWorth.x)) +
  geom_point() +
  coord_flip() 

## should do something with this to show the degree, self_made, networth, etc. 

usa_billionaires <- combined_billionaires %>% filter(Country.x == "United States")
ggplot(data = usa_billionaires, aes(x = Self_made)) +
  geom_bar() 

forbes_billionaires %>% group_by(Status) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

tidy_education <- forbes_billionaires %>% 
  separate(col = Education, into = c("Degree", "University"),
                                 sep = ", ") %>%
  select(Degree, University, everything())
tidy_education

tidy_education %>% group_by(Degree) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

tidy_education %>% filter(University == "Harvard University")

tidy_education2 <- tidy_education %>% filter(Degree == "Bachelor of Arts/Science" |
                          Degree == "Master of Business Administration" |
                          Degree == "Master of Science" |
                          Degree == "Drop Out" |
                          Degree == "Bachelor of Science" |
                          Degree == "Bachelor of Science in Engineering" |
                          Degree == "Doctorate" |
                          Degree == "Diploma" |
                          Degree == "Bachelor of Arts/Economic")


ggplot(data = tidy_education2, aes(x = Degree, y = NetWorth)) +
  geom_point(alpha = 0.4) +
  coord_flip() +
  labs(x = "Education Level",
       y = "Net Worth")

ggplot(data = tidy_education2, aes(x = Degree, y = NetWorth)) +
  geom_jitter(alpha = 0.4) +
  coord_flip() +
  labs(x = "Education Level",
       y = "Net Worth")

ggplot(data = tidy_education2, aes(x = Degree, y = NetWorth)) +
  geom_violin() +
  coord_flip()
``` 

###### Showing All U.S. Billionaires 
```{r}
library(plotly)
us_forbes_billionaires <- combined_billionaires %>% filter(Country.x == "United States")
us_forbes_billionaires

us_forbes_billionaires %>% group_by(Industry) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

plot10 <- ggplot(data = us_forbes_billionaires, aes(x = NetWorth.x, y = Age.x,
                                                    label = Name, colour = Industry)) +
  geom_jitter() +
  labs(x = "NetWorth",
       y = "Age",
       title = "Billionaires in the U.S.") +
  theme(plot.title = element_text(face = "bold",
                                  size = 15,
                                  margin = margin(c(t = 10, b = 10))),
        axis.ticks = element_blank(),
        legend.title = element_text(face = "bold"),
        axis.title = element_text(face = "bold"))

ggplotly(plot10, tooltip = "label")
```

###### Try to make the Map
```{r}
library(maps)
library(tidyverse)
state_df <- ggplot2::map_data("state")

forbes_billionaires_geo <- read_csv(here("content/post/2022-04-26-2021-forbes-billionaires/forbes_billionaires_geo.csv"))
forbes_billionaires_geo %>% select(geometry, everything())
```
